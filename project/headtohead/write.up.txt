So, while we're deep into the off-season, I thought this might be a good time to introduce what I suspect might be quite a niche thread! 

The first thing I thought I'd talk about is a slightly different way of looking at race pace. In the past I've posted summaries after each race listing how fast I estimate each driver to have been. They were generally in the right ballpark I think, although there were examples of where it would misrank drivers due to certain situations. Looking back, I think trying to rank every driver after every race and worrying about how accurate each one was missed the point a bit. As regular fans, we know that driver pace, and pace compared to your teammate for example, can vary from race to race. Whether a driver was three tenths fast or two tenths faster in a single race isn't normally that interesting. What is a lot more interesting is what the overall long term trend is. If you take e.g. ten races where team mates have had representative races, the variation from race to race has cancelled out and we should have a large enough set of lap times to have a trustworthy comparison. That's the angle we take in this post.



We'll start off with an example from this season. We'll look at the Ferrari drivers.
Leclerc completed 1156 laps, Vettel 1178. 
Some of these are obviously not representative, e.g laps behind the safety car, lap 1, safety car restart laps, inlaps, outlaps. Filtering those out, that leaves us with 982 laps for Leclerc and 984 for Vettel.
However, we want to compare their lap times directly, so we will only look at the laps where both Leclerc and Vettel were on track at the same time. Reliability is good these days so luckily that leaves us with 862 laps that we can compare. When we do this, we find that on average Vettel is 0.119 seconds/lap faster in these laps.
However sometimes drivers obviously have a problem with their car, e.g. due to an earlier collision or a mechanical issue. It didn't affect the Ferrari drivers much this year but Leclerc had big engine problems towards the end of the race in Bahrain and did a few slow laps at the start of the Japanese Grand Prix with a damaged car. We don't want to include those lap times because they are not representative. That leaves 850 laps overall. Looking at those laps we find that Vettel is now 0.072 seconds/lap faster.
We then need to make a big reduction though - it's not fair to compare their lap times when one driver is stuck in traffic while the other is in clear air. This culls quite a lot of laps. After filtering down to laps where both drivers are in clear air, we have 575 laps overall. Vettel's average lap time is 0.055 seconds/lap faster using these laps.
We next introduce a feature that I had on the backburner for a long time but never got around to introducing when I was doing the race by race analysis. It's common for a driver to have nothing to play for towards the end of a race. In that situation, a driver will tend to turn the engine down, take it easy on the brakes and tyres and make sure they bring the car home. We don't wanbt to use these lap times when estimating the driver's representative pace. The question is, how can we tell that a driver is in this situation? I use race simulations.
We can best illustrate the method with an example that happened in 2019 and was discussed a bit in the 2019 race pace thread. Here are Hulkenberg and Ricciardo's lap times in the Italian Grand Prix:

So we see Ricciardo having a solid advantage in the first stint, but after the pit stops, Hulkenberg is quicker. Their race pace estimate was similar for the race.

However, in this next plot, I display two graphs. The top one shows the expected finishing position for each driver at each lap of the race. This is based on where they are in the race at the time, it then simluates the rest of the race, where the expected lap times are based on the pace they have shown so far in the race, plus whether they are likely to overtake/get overtaken/get blocked by other drivers until the end of the race. I have a basic model for overtaking probabilities (which is quite interesting in its own right and which I might talk about in this thread one day). So we see that at the start of the race, Ricciardo is expected to finish in about 7th place, Hulkenberg about 8th (they started in 5th and 6th but were expected to get overtaken by Albon and Verstappen before the end of the race). As it happens, their expected finishing positions improve soon, partly because Vettel had an accident and dropped to the back of the race, plus Verstappen lost time due to a lap 1 incident, and Albon also dropped back a bit in the early laps. So in the second half of the race, Ricciardo is expected to finish 4th, Hulkenberg is expected to finish 5th.

However, we next look at the bottom plot. This shows the probability that each driver will finish in their expected position. At the start of the race, these probabilities are low - which makes sense, we might predict that Ricciardo is most likely to finish about 5th e.g. but lots of things can still happen in the race, we don't know how it will pan out, he could easily not finish in 5th! But by lap 35, Ricciardo was in 4th, 22 seconds behind Bottas and 18 seconds ahead of Hulkenberg. It's highly unlikely that he will catch Bottas or get caught by Hulkenberg, so the simulations are effectively certain he will finish 4th. That's why we see a probability of 1 on the y-axis for him from lap 35 onwards.
As for Hulkenberg, things are a little different. He was 11 seconds ahead of Albon, but Albon was catching and there were still 18 laps remaining. It's likely he will stay ahead but we can't be sure. By lap 45, he was only 4 seconds ahead. As a result, the simulations still think he's likely to hold on to 5th position but it's not certain - looking at the lower graph, it's only about 83% sure he'll finish in 5th.
So, overall we can say that from about lap 30 onwards, Ricciardo had nothing to play for. As a result, we shouldn't use these lap times when comparing his pace to Hulkenberg. We'll borrow a common sporting phrase and call these 'dead rubber' laps.

So, back to Leclerc and Vettel, by the time we've calculated which of their laps are dead rubbers and eliminated them, we've got 
390 laps left over. Vettel's advantage now? 0.045.

So, I've displayed a few different ways of calculating the pace difference between the Ferrari drivers. You can debate which one you think is the most reliable, but luckily it doesn't make a massive difference which you choose, the answer comes out fairly similar in most cases, i.e. it's very close.

There's an important factor I've not talked about so far though - were the drivers always on a comparable strategy throughout these laps? What if Leclerc was using older tyres, or was on a worse tyre than Vettel during some of these laps? We would like to adjust for that if possible - it's what I did when I was estimating race pace. The way it works is, let's say Vettel set a lap time of e.g 1:20.1 and Leclerc set a lap time of 1:20.5. However, Leclerc's tyres were ten laps older and my calculations suggest that cost him 0.15 seconds/lap compared to Vettel. Instead of treating Vettel's lap as 0.4 seconds/lap faster, I treat it as 0.4 - 0.15 = 0.25 seconds/lap faster. There is an issue of how reliable that 0.15 number is. It's not an exact science but I would argue that even a basic estimate, as I've done, is better than doing nothing. But obviously you can decide for yourself if you want to use my adjusted numbers.

If you do, it's still close but Leclerc tunrs out to be marginally faster now, by 0.011 seconds/lap. As it happens, Leclerc's tyres were on average 14.43 laps old during the laps we included, while Vettel's were on aveage 13.42 laps old during the same laps. So Leclerc had on average tyres that were one lap older, so it makes sense that we've adjusted the comparison slightly in his favour.

So these comparisons are a little different to the ones I did before, firstly, because they only take into account laps when both drivers were in the race at the same time. Secondly, because now you can see what the average lap times are when you just look at the raw lap times, as well as when you adjust for tyre type and age. When I presented the result previously, the tyre adjustments were made throughout, so it was hard to see just how big an impact they were having.

So, let's now present these calculations for all the teams in the 2019 season:

I think you can probably work out what the numbers mean by referring back to the Ferrari drivers section, but, for example, Verstappen is 0.795 seconds/lap faster than Gasly looking at all 578 laps they both drove. Then we filter out 'bad' laps as we move across the columns.

In general, the closer all the numbers are for a pairing, the more I feel we can trust the comparison. For example, the Magnussen/Grosjean comparison is very consistent, with Grosjean being between 0.02 and 0.081 seconds/lap faster than Magnussen whichever column you look at. On the other hand, the Renault comparison is a lot more dubious. They seem to be extremely close when you look at the raw lap time averages, but once we adjust for the tyres, Ricciardo is rated as 0.255 seconds/lap faster. If you look at the final two columns you can see why though: Ricciardo's tyres were on average almost six laps older during the included laps. These numbers do show how messy lap time comparison is though - there were 1262 racing laps in total this year, yet we can only compare the Renault driver's pace for 164 of them!

I have these calculations available for previous seasons, back to 2011, by the way, so let me know if you're interested in seeing them and I can display those too.

